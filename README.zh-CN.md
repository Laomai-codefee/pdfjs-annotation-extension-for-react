> âš ï¸ **InkLayer ç”Ÿæ€é¡¹ç›®**
>
> æœ¬ä»“åº“æä¾› InkLayer çš„ React ç»‘å®šåŠç¤ºä¾‹é›†æˆï¼Œç”¨äºåœ¨å‰ç«¯åº”ç”¨ä¸­å¿«é€Ÿæ¥å…¥ PDF æ‰¹æ³¨èƒ½åŠ›ã€‚
>
> ğŸ‘‰ **InkLayer ä¸»å…¥å£ï¼š** https://github.com/Laomai-codefee/inklayer

<div>
    <h1 align="center"><code>pdfjs-annotation-extension-for-react</code> âš¡ï¸ </h1>
    <p align="center">
        <strong>ä¸€ä¸ªåŸºäº PDF.js æ„å»ºçš„è½»é‡çº§ã€å¯æ‰©å±•çš„ React PDF æ‰¹æ³¨å™¨å’ŒæŸ¥çœ‹å™¨</strong><br/> æ”¯æŒç¼–è¾‘ç°æœ‰ PDF æ–‡ä»¶æ‰¹æ³¨ã€å‘å¸ƒè¯„è®ºã€å›å¤ã€æäº¤æ³¨é‡Šæ•°æ®å’ŒåŠ è½½ä»¥è¿›è¡Œè¿›ä¸€æ­¥ç¼–è¾‘ã€‚
    </p>
</div>

---
[English](./README.md) ï½œ ç®€ä½“ä¸­æ–‡
---

[![NPM](https://img.shields.io/npm/v/pdfjs-annotation-extension-for-react.svg)](https://www.npmjs.com/package/pdfjs-annotation-extension-for-react)
[![License](https://img.shields.io/npm/l/pdfjs-annotation-extension-for-react)](./LICENSE)

## åœ¨çº¿æ¼”ç¤º

[![Demo](https://img.shields.io/badge/ğŸ”¥_Live_Demo-React_PDF_Viewer_Plus-FF6F61?style=for-the-badge&logo=github&logoColor=white)](https://laomai-codefee.github.io/pdfjs-annotation-extension-for-react-demo/)

## âœ¨ ç‰¹æ€§

- âœï¸ ä¸°å¯Œçš„æ³¨é‡Šç³»ç»Ÿ
  - é«˜äº®ã€ç»˜å›¾ã€å½¢çŠ¶ã€æ–‡æœ¬æ³¨é‡Š
  - ç­¾åï¼ˆæ‰‹ç»˜ / è¾“å…¥ / ä¸Šä¼ ï¼‰
  - å¸¦ç¼–è¾‘å™¨æ”¯æŒçš„å°ç« 
  - ç›´æ¥ç¼–è¾‘åŸç”Ÿ PDF æ³¨é‡Š
- ğŸ“„ åŸºäº PDF.js çš„é«˜ä¿çœŸ PDF æ¸²æŸ“
- ğŸ¨ åŸºäº Radix UI Themes çš„ä¸»é¢˜ç³»ç»Ÿ
- ğŸŒ å›½é™…åŒ–ï¼ˆä¸­æ–‡ç®€ä½“ã€è‹±æ–‡ï¼‰
- ğŸ§© é«˜åº¦å¯è‡ªå®šä¹‰çš„ UI
  - å·¥å…·æ  / ä¾§è¾¹æ  / æ“ä½œå®Œå…¨å¯è¦†ç›–
- ğŸ¢ ä¼ä¸šå‹å¥½é…ç½®
  - `defaultOptions` æ”¯æŒæ·±åº¦éƒ¨åˆ† + æ·±åº¦åˆå¹¶
- ğŸ’¾ å¯¼å‡º
  - å°†æ³¨é‡Šå¯¼å‡ºä¸º PDF
  - å°†æ³¨é‡Šå¯¼å‡ºä¸º Excel
- ğŸ§  ä¸ºå¯æ‰©å±•æ€§è€Œè®¾è®¡
  - æ¸…æ™°çš„ä¸Šä¸‹æ–‡å’Œæ‰©å±•æ¶æ„

## âœï¸ æ‰¹æ³¨å·¥å…·

1. çŸ©å½¢
2. åœ†å½¢
3. è‡ªç”±æ‰‹ç»˜ï¼ˆçŸ­æ—¶é—´å†…ç»˜åˆ¶çš„ä¼šè¢«åˆ†ç»„ï¼‰
4. è‡ªç”±é«˜äº®ï¼ˆå¸¦è‡ªåŠ¨æ ¡æ­£ï¼‰
5. ç®­å¤´
6. äº‘çº¿
7. è‡ªç”±æ–‡æœ¬
8. ç­¾å ï¼ˆä¸Šä¼ ã€æ‰‹ç»˜ã€è¾“å…¥ã€é»˜è®¤ç­¾åï¼‰
9. å°ç« ï¼ˆä¸Šä¼ è‡ªå®šä¹‰å›¾ç‰‡ã€è‡ªå®šä¹‰å°ç« ã€ é»˜è®¤å°ç« ï¼‰
10. æ–‡æœ¬é«˜äº®
11. æ–‡æœ¬åˆ é™¤çº¿
12. æ–‡æœ¬ä¸‹åˆ’çº¿
13. æ–‡æœ¬

## âœï¸ ç¼–è¾‘ PDF æ–‡ä»¶ä¸­çš„ç°æœ‰æ‰¹æ³¨

1. çŸ©å½¢
2. åœ†å½¢
3. ç»˜åˆ¶
4. è‡ªç”±æ–‡æœ¬
5. çº¿æ¡
6. å¤šè¾¹å½¢
7. æŠ˜çº¿
8. æ–‡æœ¬
9. é«˜äº®
10. ä¸‹åˆ’çº¿
11. åˆ é™¤çº¿

## ğŸ“¦ å®‰è£…

```bash
npm install pdfjs-annotation-extension-for-react
or
yarn add pdfjs-annotation-extension-for-react
```

# ğŸš€ å¿«é€Ÿå¼€å§‹

## 1. PDF æ‰¹æ³¨

```jsx
import { PdfAnnotator } from 'pdfjs-annotation-extension-for-react'
import 'pdfjs-annotation-extension-for-react/style'

export default function App() {
  return (
    <PdfAnnotator
      title="PDF Annotator"
      url="https://example.com/sample.pdf"
      user={{ id: 'u1', name: 'Alice' }}
      onSave={(annotations) => {
        console.log('Saved annotations:', annotations)
      }}
    />
  )
}
```

## 2. åŸºç¡€ PDF æŸ¥çœ‹å™¨

```jsx
import { PdfViewer } from 'pdfjs-annotation-extension-for-react'
import 'pdfjs-annotation-extension-for-react/style'

export default function App() {
  return (
    <PdfViewer
      title="PDF Viewer"
      url="https://example.com/sample.pdf"
      layoutStyle={{ width: '100vw', height: '100vh' }}
    />
  )
}
```

# ğŸ§© ç»„ä»¶

### åŸºç¡€å±æ€§

| Name                   | Type                    | Default                                 | Description                                            |
| ---------------------- | ----------------------- | --------------------------------------- | ------------------------------------------------------ |
| `appearance`         | `auto \| dark \| light`       | `auto`                       | Dark or Light theme. 
| `theme`              | Radix Theme Color       | `violet`                              | Theme color of the viewer UI                           |
| `title`              | `React.ReactNode`     | â€”                                      | Page title content; accepts text or custom React nodes |
| `url *`              | `string \| URL`        | â€”                                      | PDF file URL; supports string URLs or `URL` objects  |
| `locale`             | `'zh-CN' \| 'en-US'`   | `zh-CN`                               | Locale used for internationalization                   |
| `initialScale`       | `PdfScale`            | `auto`                                | Initial zoom level of the PDF viewer                   |
| `layoutStyle`        | `React.CSSProperties` | `{ width: '100vw', height: '100vh' }` | Styles applied to the PDF viewer container             |
| `isSidebarCollapsed` | `boolean`             | `false`                               | Whether the sidebar is collapsed by default            |
| `enableRange`        | `boolean \| 'auto'`    | `auto`                                | Enables HTTP Range (streaming) loading for PDFs        |

## âœï¸ PdfAnnotator -  PDFæ‰¹æ³¨å™¨

å…·æœ‰æ³¨é‡ŠåŠŸèƒ½çš„é«˜çº§ PDF æŸ¥çœ‹å™¨

### å±æ€§

| Name                        | Type                                                                | Default                             | Description                                                          |
| --------------------------- | ------------------------------------------------------------------- | ----------------------------------- | -------------------------------------------------------------------- |
| `user`                    | `User`                                                            | `{ id: 'null', name: 'unknown' }` | Current user information<br />used to identify the annotation author |
| `enableNativeAnnotations` | `boolean`                                                         | `false`                           | Native annotations embedded in the PDF file                          |
| `defaultShowAnnotationsSidebar` | `boolean`                                                   | `false`                           | Show Annotations Sidebar                                             |
| `defaultOptions`          | `DeepPartial`                                                     | â€”                                  | Default configuration for the annotator;                             |
| `initialAnnotations`      | `IAnnotationStore[]`                                              | â€”                                  | Existing annotations to be rendered during initialization            |
| `actions`                 | `React.ReactNode \| React.ComponentType`                           | â€”                                  | Custom actions areaÂ                                                 |
| `onSave`                  | `(annotations: IAnnotationStore[]) => void`                       | â€”                                  | Callback triggered when annotations are saved                        |
| `onLoad`                  | `() => void`                                                      | â€”                                  | Callback triggered when the PDF and annotator are fully loaded       |
| `onAnnotationAdded`       | `(annotation: IAnnotationStore) => void`                          | â€”                                  | Fired when a new annotation is created                               |
| `onAnnotationDeleted`     | `(id: string) => void`                                            | â€”                                  | Fired when an annotation is deleted                                  |
| `onAnnotationSelected`    | `(annotation: IAnnotationStore \| null, isClick: boolean) => void` | â€”                                  | Fired when an annotation is selected or deselected                   |
| `onAnnotationUpdated`     | `(annotation: IAnnotationStore) => void`                          | â€”                                  | Fired when an existing annotation is modified                        |

### âš™ï¸ defaultOptions

#### âœ… æ·±åº¦éƒ¨åˆ† + æ·±åº¦åˆå¹¶

`defaultOptions` ä¸æ˜¯å®Œæ•´çš„é…ç½®è¦†ç›–

- å®ƒè¢«å®šä¹‰ä¸º `DeepPartial<PdfAnnotatorOptions> `
- å®ƒå°†ä¸ç³»ç»Ÿé»˜è®¤é…ç½®è¿›è¡Œæ·±åº¦åˆå¹¶

è¿™ç¡®ä¿äº†ï¼š
- æ‚¨åªéœ€è¦†ç›–éœ€è¦çš„å†…å®¹
- ç³»ç»Ÿé»˜è®¤å€¼ä¿æŒç¨³å®š
- é€‚åˆé•¿æœŸä¼ä¸šä½¿ç”¨

#### ç¤ºä¾‹

```tsx
import qiantubifengshouxietiFont from './fonts/qiantubifengshouxieti.ttf';

<PdfAnnotator
    url="sample.pdf"
    defaultOptions={{
        colors: ['#000', '#1677ff'],
        signature: {
            colors: ['#000000', '#ff0000', '#1677ff'],
            type: 'Upload',
            maxSize: 1024 * 1024 * 5,
            accept: '.png,.jpg,.jpeg,.bmp',
            defaultSignature: ['data:image/png;base64,...'],
            defaultFont: [
                {
                    label: 'æ¥·ä½“',
                    value: 'STKaiti',
                    external: false
                },
                {
                    label: 'åƒå›¾ç¬”é”‹æ‰‹å†™ä½“',
                    value: 'qiantubifengshouxieti',
                    external: true,
                    url: qiantubifengshouxietiFont
                },
                {
                    label: 'å¹³æ–¹é•¿å®‰ä½“',
                    value: 'PingFangChangAnTi-2',
                    external: true,
                    url: 'http://server/PingFangChangAnTi-2.ttf'
                }
            ]
        },
        stamp: {
            maxSize: 1024 * 1024 * 5,
            accept: '.png,.jpg,.jpeg,.bmp',
            defaultStamp: ['data:image/png;base64,...'],
            editor: {
                defaultBackgroundColor: '#2f9e44',
                defaultBorderColor: '#2b8a3e',
                defaultBorderStyle: 'none',
                defaultTextColor: '#fff',
                defaultFont: [
                    {
                        label: 'æ¥·ä½“',
                        value: 'STKaiti'
                    }
                ]
            }
        }
    }}
/>
```

### ğŸ¨ è‡ªå®šä¹‰UI

####  Actions

```jsx
<PdfAnnotator
  url={pdfUrl}
  actions={({ save, exportToPdf, exportToExcel }) => (
    <>
      <button onClick={save}>Save</button>
      <button onClick={() => exportToPdf('annotations')}>
        Export PDF
      </button>
      <button onClick={() => exportToExcel('annotations')}>
        Export Excel
      </button>
    </>
  )}
/>
```

### ğŸ–‹ ç­¾åå’Œå°ç« é…ç½®

```jsx
<PdfAnnotator
  url={pdfUrl}
  defaultOptions={{
    signature: {
      defaultSignature: ['data:image/png;base64,...'],
      defaultFont: [
        {
          label: 'Custom Font',
          value: 'MyFont',
          external: true,
          url: '/fonts/myfont.ttf'
        }
      ]
    },
    stamp: {
      defaultStamp: ['data:image/png;base64,...']
    }
  }}
/>
```

## ğŸ“„ PdfViewer - PDF æŸ¥çœ‹å™¨

å…·æœ‰å·¥å…·æ ã€ä¾§è¾¹æ ã€æ“ä½œå’Œå¯æ‰©å±• UI æ’æ§½çš„è½»é‡çº§ PDF æŸ¥çœ‹å™¨ã€‚

### Props

| Name                   | Type                                                                      | Default   | Description                                                                                |
| ---------------------- | ------------------------------------------------------------------------- | --------- | ------------------------------------------------------------------------------------------ |
| `actions`            | `React.ReactNode \| (context: PdfViewerContextValue) => React.ReactNode` | â€”        | Custom actions area in the toolbar                                                         |
| `sidebar`            | `SidebarPanel[]` | â€”        | Custom sidebar component                                                                   |
| `toolbar`            | `React.ReactNode \| (context: PdfViewerContextValue) => React.ReactNode` | â€”        | Custom toolbar component                                                                   |
| `showTextLayer`      | `boolean`                                                               | `true`  | Whether to render the text layer                                                           |
| `showAnnotations`      | `boolean`                                                               | `false`  | Whether to render the pdf annotations layer                                              |
| `defaultActiveSidebarKey`      | `string`                                                     | null  | Default Active Sidebar Key                                                       |
| `onDocumentLoaded`   | `(pdfViewer: PDFViewer \| null) => void`                                 | â€”        | Callback invoked when the PDF <br />document is fully loaded and the viewer is initialized |
| `onEventBusReady`    | `(eventBus: EventBus \| null) => void`                                   | â€”        | Callback invoked when the pdf.js EventBus is ready                                         |

### ğŸ¨ è‡ªå®šä¹‰ UI

####  Toolbar

```jsx
<PdfViewer
  url={pdfUrl}
  toolbar={(context) => (
    <>
    <button onClick={() => console.log(context.pdfViewer)}>
        PDF Viewer
    </button>
    <button onClick={context.toggleSidebar}>
        Toggle Sidebar
    </button>
    <button onClick={() => context.setSidebarCollapsed(false)}>
        Open Sidebar
    </button>
    <button onClick={() => context.setSidebarCollapsed(true)}>
        Close Sidebar
    </button>
</>
  )}
/>
```

###  Sidebar

```jsx
<PdfViewer
  url={pdfUrl}
   sidebar={[{
            key: 'sidebar-1',
            title: 'Sidebar 1',
            icon: <BsLayoutTextSidebar />,
            render: (context) => (
                <div style={{ display: 'flex', gap: 10, flexDirection: 'column' }}>
                    Sidebar 1
                    <button onClick={context.toggleSidebar}>
                        toggleSidebar
                    </button>
                    <button onClick={() => console.log(context.pdfViewer)}>
                        Get PDF Viewer
                    </button>
                    <button onClick={() => {
                        context.pdfViewer?.scrollPageIntoView({
                            pageNumber: 1
                        })
                    }}>
                        goto page1
                    </button>
                    <button onClick={() => {
                        context.pdfViewer?.scrollPageIntoView({
                            pageNumber: 10
                        })
                    }}>
                        goto page 10
                    </button>
                </div>
            )
        }]}
/>
```

### Actions

```jsx
<PdfViewer
  url={pdfUrl}
  actions={(context) => (
    <>
        <button onClick={() => console.log(context.pdfViewer)}>
            PDF Viewer
        </button>
        <button onClick={context.toggleSidebar}>
            Toggle Sidebar
        </button>
        <button onClick={() => context.setSidebarCollapsed(false)}>
            Open Sidebar
        </button>
        <button onClick={() => context.setSidebarCollapsed(true)}>
            Close Sidebar
        </button>
    </>
  )}
/>
```

---

# ğŸŒ æµè§ˆå™¨æ”¯æŒ

- Chrome (latest)
- Firefox (latest)
- Safari (latest)
- Edge (latest)

# ğŸ“„ è®¸å¯è¯

MIT
